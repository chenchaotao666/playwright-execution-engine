!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).PlaywrightExecutionEngine={})}(this,function(t){"use strict";var e=Object.defineProperty,i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,i,n)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n,s=(t,e)=>{for(var s in e||(e={}))n.call(e,s)&&o(t,s,e[s]);if(i)for(var s of i(e))r.call(e,s)&&o(t,s,e[s]);return t},l=(t,e,i)=>new Promise((n,r)=>{var o=t=>{try{l(i.next(t))}catch(e){r(e)}},s=t=>{try{l(i.throw(t))}catch(e){r(e)}},l=t=>t.done?n(t.value):Promise.resolve(t.value).then(o,s);l((i=i.apply(t,e)).next())});class u{constructor(t="info"){this.level=t,this.levels={debug:0,info:1,warn:2,error:3}}debug(t,...e){this.levels[this.level]<=this.levels.debug&&console.debug(`[DEBUG] ${t}`,...e)}info(t,...e){this.levels[this.level]<=this.levels.info&&console.info(`[INFO] ${t}`,...e)}warn(t,...e){this.levels[this.level]<=this.levels.warn&&console.warn(`[WARN] ${t}`,...e)}error(t,...e){this.levels[this.level]<=this.levels.error&&console.error(`[ERROR] ${t}`,...e)}success(t,...e){this.levels[this.level]<=this.levels.info&&console.log(`%c[SUCCESS] ${t}`,"color: green",...e)}}"undefined"!=typeof window&&(window.PlaywrightLogger=u),"undefined"!=typeof module&&module.exports&&(module.exports=u);class a{constructor(){this.defaultTimeout=3e4,this.logger=new(window.PlaywrightLogger||console)}querySelector(t){if(t.startsWith("xpath=")){const e=t.substring(6);return document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}if(t.startsWith("text=")){const e=`//*[contains(normalize-space(text()), "${t.substring(5)}")]`;return document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}return document.querySelector(t)}waitForElement(t){return l(this,arguments,function*(t,e=this.defaultTimeout){return new Promise((i,n)=>{const r=Date.now(),o=this.querySelector(t);if(o)return this.logger.debug(`å…ƒç´ ç«‹å³æ‰¾åˆ°: ${t}`),i(o);let s,l;const u=()=>{s&&clearTimeout(s),l&&l.disconnect()};s=setTimeout(()=>{u(),n(new Error(`ç­‰å¾…å…ƒç´ è¶…æ—¶: ${t} (${e}ms)`))},e),l=new MutationObserver(()=>{const e=this.querySelector(t);if(e){u();const n=Date.now()-r;this.logger.debug(`å…ƒç´ æ‰¾åˆ°: ${t} (${n}ms)`),i(e)}}),l.observe(document.body,{childList:!0,subtree:!0,attributes:!0})})})}waitForCondition(t){return l(this,arguments,function*(t,e=this.defaultTimeout,i="ç­‰å¾…æ¡ä»¶è¶…æ—¶"){return new Promise((n,r)=>{const o=Date.now(),s=()=>l(this,null,function*(){try{const e=yield t();if(e){const t=Date.now()-o;return this.logger.debug(`æ¡ä»¶æ»¡è¶³ (${t}ms)`),void n(e)}}catch(l){this.logger.debug("æ¡ä»¶æ£€æŸ¥å‡ºé”™ï¼Œç»§ç»­ç­‰å¾…:",l.message)}Date.now()-o>=e?r(new Error(`${i} (${e}ms)`)):setTimeout(s,100)});s()})})}waitForFunction(t){return l(this,arguments,function*(t,e=this.defaultTimeout){return this.waitForCondition(t,e,"ç­‰å¾…å‡½æ•°æ¡ä»¶è¶…æ—¶")})}waitForURL(t){return l(this,arguments,function*(t,e=this.defaultTimeout){return this.waitForCondition(()=>{const e=window.location.href;return"string"==typeof t?e.includes(t):t instanceof RegExp&&t.test(e)},e,`ç­‰å¾…URLå˜åŒ–è¶…æ—¶: ${t}`)})}waitForLoadState(t="load"){return l(this,null,function*(){return new Promise(e=>{const i=()=>{"load"===t&&"complete"===document.readyState?(this.logger.debug("é¡µé¢å®Œå…¨åŠ è½½"),e()):"domcontentloaded"===t&&"loading"!==document.readyState?(this.logger.debug("DOM å†…å®¹åŠ è½½å®Œæˆ"),e()):"networkidle"===t&&setTimeout(()=>{this.logger.debug("ç½‘ç»œç©ºé—²"),e()},500)};"complete"===document.readyState&&"load"===t||"loading"!==document.readyState&&"domcontentloaded"===t?e():document.addEventListener("readystatechange",i,{once:!0})})})}waitForTimeout(t){return l(this,null,function*(){return this.logger.debug(`ç­‰å¾… ${t}ms`),new Promise(e=>setTimeout(e,t))})}}"undefined"!=typeof window&&(window.PlaywrightWaitManager=a),"undefined"!=typeof module&&module.exports&&(module.exports=a);class c{constructor(){this.logger=new(window.PlaywrightLogger||console)}simulateClick(t,e={}){const{button:i=0,clickCount:n=1,delay:r=0}=e;t.focus();["mousedown","mouseup","click"].forEach((e,o)=>{setTimeout(()=>{const r=new MouseEvent(e,{view:window,bubbles:!0,cancelable:!0,button:i,detail:n});t.dispatchEvent(r),this.logger.debug(`è§¦å‘ ${e} äº‹ä»¶`)},r*o)})}simulateDoubleClick(t){this.simulateClick(t,{clickCount:1}),setTimeout(()=>{const e=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0,detail:2});t.dispatchEvent(e),this.logger.debug("è§¦å‘ dblclick äº‹ä»¶")},100)}simulateHover(t){["mouseover","mouseenter"].forEach(e=>{const i=new MouseEvent(e,{view:window,bubbles:!0,cancelable:!0});t.dispatchEvent(i),this.logger.debug(`è§¦å‘ ${e} äº‹ä»¶`)})}simulateKeyPress(t,e,i={}){const{ctrlKey:n=!1,shiftKey:r=!1,altKey:o=!1,metaKey:s=!1}=i;t.focus();const l=new KeyboardEvent("keydown",{key:e,code:this.getKeyCode(e),bubbles:!0,cancelable:!0,ctrlKey:n,shiftKey:r,altKey:o,metaKey:s});if(t.dispatchEvent(l),"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName||this.handleNavigationKey(t,e),!["Home","End","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Backspace","Delete"].includes(e)){const i=new KeyboardEvent("keypress",{key:e,code:this.getKeyCode(e),bubbles:!0,cancelable:!0,ctrlKey:n,shiftKey:r,altKey:o,metaKey:s});t.dispatchEvent(i)}const u=new KeyboardEvent("keyup",{key:e,code:this.getKeyCode(e),bubbles:!0,cancelable:!0,ctrlKey:n,shiftKey:r,altKey:o,metaKey:s});t.dispatchEvent(u),this.logger.debug(`è§¦å‘é”®ç›˜äº‹ä»¶: ${e}`)}handleNavigationKey(t,e){const i=t.selectionStart||0,n=t.selectionEnd||0,r=t.value||"";switch(e){case"Home":t.setSelectionRange(0,0);break;case"End":t.setSelectionRange(r.length,r.length);break;case"ArrowLeft":if(i>0){const e=Math.max(0,i-1);t.setSelectionRange(e,e)}break;case"ArrowRight":if(i<r.length){const e=Math.min(r.length,i+1);t.setSelectionRange(e,e)}break;case"Backspace":i===n&&i>0?(t.value=r.slice(0,i-1)+r.slice(n),t.setSelectionRange(i-1,i-1),t.dispatchEvent(new Event("input",{bubbles:!0}))):i!==n&&(t.value=r.slice(0,i)+r.slice(n),t.setSelectionRange(i,i),t.dispatchEvent(new Event("input",{bubbles:!0})));break;case"Delete":i===n&&i<r.length?(t.value=r.slice(0,i)+r.slice(n+1),t.setSelectionRange(i,i),t.dispatchEvent(new Event("input",{bubbles:!0}))):i!==n&&(t.value=r.slice(0,i)+r.slice(n),t.setSelectionRange(i,i),t.dispatchEvent(new Event("input",{bubbles:!0})))}}simulateTyping(t,e){return l(this,arguments,function*(t,e,i={}){const{delay:n=50}=i;t.focus();for(let r=0;r<e.length;r++){const i=e[r],o=t.selectionStart||0,s=t.selectionEnd||0,l=t.value||"",u=l.slice(0,o)+i+l.slice(s);t.value=u;const a=o+1;t.setSelectionRange(a,a),t.dispatchEvent(new Event("input",{bubbles:!0})),this.simulateKeyPress(t,i),n>0&&(yield new Promise(t=>setTimeout(t,n)))}t.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`è¾“å…¥æ–‡æœ¬: "${e}"`)})}simulateFormChange(t,e){"checkbox"===t.type||"radio"===t.type?t.checked=e:(t.tagName,t.value=e),t.dispatchEvent(new Event("input",{bubbles:!0})),t.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`è¡¨å•æ§ä»¶å˜åŒ–: ${t.tagName} = ${e}`)}getKeyCode(t){return{Enter:"Enter",Escape:"Escape",Tab:"Tab",Backspace:"Backspace",Delete:"Delete",Home:"Home",End:"End",ArrowUp:"ArrowUp",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight"," ":"Space"}[t]||t}scrollIntoView(t){return l(this,arguments,function*(t,e={}){const{behavior:i="smooth",block:n="center"}=e;t.scrollIntoView({behavior:i,block:n}),yield new Promise(t=>setTimeout(t,100)),this.logger.debug("å…ƒç´ æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸ")})}}"undefined"!=typeof window&&(window.PlaywrightEventSimulator=c),"undefined"!=typeof module&&module.exports&&(module.exports=c);class h{constructor(t,e,i={}){this.selector=t,this.page=e,this.options=i,this.filters=[],this.logger=new(window.PlaywrightLogger||console),this.waitManager=e.waitManager,this.eventSimulator=e.eventSimulator}filter(t){const e=new h(this.selector,this.page);return e.filters=[...this.filters,t],e}first(){return this.nth(0)}last(){return this.filter({position:"last"})}nth(t){return this.filter({position:t})}locator(t,e={}){const i=this.combineSelectorWithParent(t),n=new h(i,this.page,e);return n.filters=[...this.filters],n}combineSelectorWithParent(t){if(t.startsWith("xpath=")){const e=t.substring(6);if(this.selector.startsWith("xpath=")){return`xpath=${this.selector.substring(6)}//${e}`}return`xpath=//*[${this.cssSelectorToXPath(this.selector)}]//${e}`}if(this.selector.startsWith("xpath=")){return`xpath=${this.selector.substring(6)}//*[${this.cssSelectorToXPath(t)}]`}return`${this.selector} ${t}`}cssSelectorToXPath(t){if(t.startsWith("#"))return`@id="${t.substring(1)}"`;if(t.startsWith("."))return`contains(@class, "${t.substring(1)}")`;if(t.startsWith("[")&&t.endsWith("]")){const e=t.match(/\[([^=]+)="([^"]+)"\]/);if(e)return`@${e[1]}="${e[2]}"`;const i=t.match(/\[([^=\]]+)\]/);if(i)return`@${i[1]}`}else if(/^[a-zA-Z][a-zA-Z0-9]*$/.test(t))return`self::${t}`;return"self::*"}getByText(t,e={}){return this.filter({hasText:t,exact:e.exact})}click(){return l(this,arguments,function*(t={}){const e=yield this.getElement();yield this.page.scrollIntoViewIfNeeded(e),this.eventSimulator.simulateClick(e,t),this.logger.debug(`ç‚¹å‡»å…ƒç´ : ${this.selector}`)})}dblclick(){return l(this,arguments,function*(t={}){const e=yield this.getElement();yield this.page.scrollIntoViewIfNeeded(e),this.eventSimulator.simulateDoubleClick(e),this.logger.debug(`åŒå‡»å…ƒç´ : ${this.selector}`)})}fill(t){return l(this,arguments,function*(t,e={}){const i=yield this.getElement();yield this.page.scrollIntoViewIfNeeded(i),i.value="",i.value=t,i.dispatchEvent(new Event("input",{bubbles:!0})),i.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`å¡«å……å…ƒç´ : ${this.selector} = "${t}"`)})}press(t){return l(this,arguments,function*(t,e={}){const i=yield this.getElement();i.focus(),this.eventSimulator.simulateKeyPress(i,t,e),this.logger.debug(`æŒ‰é”®: ${this.selector} -> ${t}`)})}pressSequentially(t){return l(this,arguments,function*(t,e={}){const i=yield this.getElement();yield this.eventSimulator.simulateTyping(i,t,e),this.logger.debug(`é€å­—ç¬¦è¾“å…¥: ${this.selector} -> "${t}"`)})}hover(){return l(this,null,function*(){const t=yield this.getElement();yield this.page.scrollIntoViewIfNeeded(t),this.eventSimulator.simulateHover(t),this.logger.debug(`æ‚¬åœå…ƒç´ : ${this.selector}`)})}check(){return l(this,null,function*(){const t=yield this.getElement();"checkbox"!==t.type&&"radio"!==t.type||(t.checked=!0,t.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`é€‰æ‹©å¤é€‰æ¡†: ${this.selector}`))})}uncheck(){return l(this,null,function*(){const t=yield this.getElement();"checkbox"===t.type&&(t.checked=!1,t.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`å–æ¶ˆé€‰æ‹©å¤é€‰æ¡†: ${this.selector}`))})}selectOption(t){return l(this,arguments,function*(t,e={}){const i=yield this.getElement();"SELECT"===i.tagName&&(Array.isArray(t)?Array.from(i.options).forEach(e=>{e.selected=t.includes(e.value)||t.includes(e.text)}):i.value=t,i.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`é€‰æ‹©ä¸‹æ‹‰é€‰é¡¹: ${this.selector} = ${t}`))})}isVisible(){return l(this,null,function*(){try{const t=yield this.getElement(),e=t.getBoundingClientRect(),i=getComputedStyle(t);return e.width>0&&e.height>0&&"hidden"!==i.visibility&&"none"!==i.display&&null!==t.offsetParent}catch(t){return!1}})}isHidden(){return l(this,null,function*(){return!(yield this.isVisible())})}isEnabled(){return l(this,null,function*(){try{const t=yield this.getElement();return!t.disabled&&!t.hasAttribute("disabled")}catch(t){return!1}})}isDisabled(){return l(this,null,function*(){return!(yield this.isEnabled())})}isChecked(){return l(this,null,function*(){try{return(yield this.getElement()).checked||!1}catch(t){return!1}})}textContent(){return l(this,null,function*(){return(yield this.getElement()).textContent||""})}innerText(){return l(this,null,function*(){return(yield this.getElement()).innerText||""})}innerHTML(){return l(this,null,function*(){return(yield this.getElement()).innerHTML||""})}getAttribute(t){return l(this,null,function*(){return(yield this.getElement()).getAttribute(t)})}inputValue(){return l(this,null,function*(){return(yield this.getElement()).value||""})}waitFor(){return l(this,arguments,function*(t={}){const{state:e="visible",timeout:i=3e4}=t;switch(e){case"visible":return this.waitForVisible(i);case"hidden":return this.waitForHidden(i);case"attached":return this.waitForAttached(i);case"detached":return this.waitForDetached(i);default:throw new Error(`æœªçŸ¥çš„ç­‰å¾…çŠ¶æ€: ${e}`)}})}waitForVisible(t){return l(this,null,function*(){return this.waitManager.waitForCondition(()=>this.isVisible(),t,`å…ƒç´  "${this.selector}" ç­‰å¾…å¯è§è¶…æ—¶`)})}waitForHidden(t){return l(this,null,function*(){return this.waitManager.waitForCondition(()=>this.isHidden(),t,`å…ƒç´  "${this.selector}" ç­‰å¾…éšè—è¶…æ—¶`)})}waitForAttached(t){return l(this,null,function*(){return this.waitManager.waitForCondition(()=>this.count()>0,t,`å…ƒç´  "${this.selector}" ç­‰å¾…é™„åŠ åˆ°DOMè¶…æ—¶`)})}waitForDetached(t){return l(this,null,function*(){return this.waitManager.waitForCondition(()=>0===this.count(),t,`å…ƒç´  "${this.selector}" ç­‰å¾…ä»DOMåˆ†ç¦»è¶…æ—¶`)})}queryElements(t){if(t.startsWith("xpath=")){const e=t.substring(6),i=document.evaluate(e,document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),n=[];for(let t=0;t<i.snapshotLength;t++)n.push(i.snapshotItem(t));return n}return Array.from(document.querySelectorAll(t))}count(){return l(this,null,function*(){const t=this.queryElements(this.selector);return this.applyFilters(t).length})}all(){return l(this,null,function*(){const t=this.queryElements(this.selector);return this.applyFilters(t).map(t=>{const e=new h(this.buildUniqueSelector(t),this.page);return e._element=t,e})})}getElement(){return l(this,null,function*(){if(this._element&&document.contains(this._element))return this._element;const t=this.queryElements(this.selector);if(0===t.length)throw new Error(`æ‰¾ä¸åˆ°å…ƒç´ : ${this.selector}`);const e=this.applyFilters(t);if(0===e.length)throw new Error(`è¿‡æ»¤åæ‰¾ä¸åˆ°å…ƒç´ : ${this.selector}`);return e[0]})}applyFilters(t){let e=t;for(const i of this.filters)e=this.applyFilter(e,i);return e}applyFilter(t,e){return"number"==typeof e.position?t[e.position]?[t[e.position]]:[]:"last"===e.position?t.length>0?[t[t.length-1]]:[]:e.hasText?t.filter(t=>{const i=t.textContent||t.innerText||"";return e.exact?i===e.hasText:i.includes(e.hasText)}):e.hasNotText?t.filter(t=>!(t.textContent||t.innerText||"").includes(e.hasNotText)):t}buildUniqueSelector(t){var e;if(t.id)return`#${t.id}`;const i=[];let n=t;for(;n&&n!==document.body;){let t=n.tagName.toLowerCase();if(n.className){const e=n.className.split(" ").filter(t=>t.trim());e.length>0&&(t+="."+e.join("."))}const r=Array.from((null==(e=n.parentNode)?void 0:e.children)||[]).filter(t=>t.tagName===n.tagName);if(r.length>1){t+=`:nth-of-type(${r.indexOf(n)+1})`}i.unshift(t),n=n.parentElement}return i.join(" > ")}}"undefined"!=typeof window&&(window.PlaywrightLocatorAdapter=h),"undefined"!=typeof module&&module.exports&&(module.exports=h);class d{constructor(){this.logger=new(window.PlaywrightLogger||console),this.waitManager=new window.PlaywrightWaitManager,this.eventSimulator=new window.PlaywrightEventSimulator}goto(t){return l(this,arguments,function*(t,e={}){const{waitUntil:i="load",timeout:n=3e4}=e;return this.logger.info(`å¯¼èˆªåˆ°: ${t}`),window.location.href!==t&&(window.location.href=t,yield this.waitForLoadState(i,n)),{url:window.location.href,status:200}})}goBack(){return l(this,arguments,function*(t={}){const{waitUntil:e="load"}=t;window.history.back(),yield this.waitForLoadState(e)})}goForward(){return l(this,arguments,function*(t={}){const{waitUntil:e="load"}=t;window.history.forward(),yield this.waitForLoadState(e)})}reload(){return l(this,arguments,function*(t={}){const{waitUntil:e="load"}=t;window.location.reload(),yield this.waitForLoadState(e)})}url(){return window.location.href}title(){return l(this,null,function*(){return document.title})}content(){return l(this,null,function*(){return document.documentElement.outerHTML})}click(t){return l(this,arguments,function*(t,e={}){const i=yield this.waitForSelector(t);yield this.scrollIntoViewIfNeeded(i),this.eventSimulator.simulateClick(i,e),this.logger.debug(`ç‚¹å‡»: ${t}`)})}dblclick(t){return l(this,arguments,function*(t,e={}){const i=yield this.waitForSelector(t);yield this.scrollIntoViewIfNeeded(i),this.eventSimulator.simulateDoubleClick(i),this.logger.debug(`åŒå‡»: ${t}`)})}fill(t,e){return l(this,arguments,function*(t,e,i={}){const n=yield this.waitForSelector(t);yield this.scrollIntoViewIfNeeded(n),n.value="",n.value=e,n.dispatchEvent(new Event("input",{bubbles:!0})),n.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`å¡«å……: ${t} = "${e}"`)})}press(t,e){return l(this,arguments,function*(t,e,i={}){const n=yield this.waitForSelector(t);n.focus(),this.eventSimulator.simulateKeyPress(n,e,i),this.logger.debug(`æŒ‰é”®: ${t} -> ${e}`)})}type(t,e){return l(this,arguments,function*(t,e,i={}){const n=yield this.waitForSelector(t);yield this.eventSimulator.simulateTyping(n,e,i),this.logger.debug(`è¾“å…¥: ${t} -> "${e}"`)})}hover(t){return l(this,null,function*(){const e=yield this.waitForSelector(t);yield this.scrollIntoViewIfNeeded(e),this.eventSimulator.simulateHover(e),this.logger.debug(`æ‚¬åœ: ${t}`)})}check(t){return l(this,null,function*(){const e=yield this.waitForSelector(t);"checkbox"!==e.type&&"radio"!==e.type||(e.checked=!0,e.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`é€‰æ‹©: ${t}`))})}uncheck(t){return l(this,null,function*(){const e=yield this.waitForSelector(t);"checkbox"===e.type&&(e.checked=!1,e.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`å–æ¶ˆé€‰æ‹©: ${t}`))})}selectOption(t,e){return l(this,arguments,function*(t,e,i={}){const n=yield this.waitForSelector(t);"SELECT"===n.tagName&&(Array.isArray(e)?Array.from(n.options).forEach(t=>{t.selected=e.includes(t.value)||e.includes(t.text)}):n.value=e,n.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`é€‰æ‹©é€‰é¡¹: ${t} = ${e}`))})}focus(t){return l(this,arguments,function*(t,e={}){const i=yield this.waitForSelector(t);yield this.scrollIntoViewIfNeeded(i),i.focus(),this.logger.debug(`èšç„¦: ${t}`)})}locator(t,e={}){const i=window.PlaywrightLocatorAdapter;if(!i)throw new Error("PlaywrightLocatorAdapter not found in global scope");return new i(t,this,e)}getByRole(t,e={}){const{name:i,exact:n=!1,level:r}=e;if(r&&"heading"===t)return this.locator(`h${r}[role="heading"], h${r}`);let o=`[role="${t}"]`;const s={button:'button, input[type="button"], input[type="submit"], input[type="reset"]',link:"a[href]",textbox:'input[type="text"], input[type="email"], input[type="password"], input[type="search"], input[type="tel"], input[type="url"], textarea',combobox:"select",checkbox:'input[type="checkbox"]',radio:'input[type="radio"]',heading:"h1, h2, h3, h4, h5, h6"};if(s[t]&&(o=`[role="${t}"], ${s[t]}`),i){let e,r=[`//*[@role="${t}"]`];if(s[t]){s[t].split(", ").forEach(t=>{if(t.includes("[")){const[e,i]=t.split("["),n=i.replace(/\]$/,"");if(n.includes("=")){const[t,i]=n.split("="),o=t.trim(),s=i.replace(/['"]/g,"").trim();r.push(`//${e}[@${o}="${s}"]`)}else{const t=n.trim();r.push(`//${e}[@${t}]`)}}else r.push(`//${t}`)})}return e=n?r.map(t=>`${t}[@aria-label="${i}"] | ${t}[normalize-space(text())="${i}"]`).join(" | "):r.map(t=>`${t}[contains(@aria-label, "${i}")] | ${t}[contains(normalize-space(text()), "${i}")]`).join(" | "),this.locator(`xpath=${e}`)}return this.locator(o)}getByText(t,e={}){const{exact:i=!1}=e;let n;return n=i?`//*[normalize-space(text())="${t}"]`:`//*[contains(normalize-space(text()), "${t}")]`,this.locator(`xpath=${n}`)}getByLabel(t,e={}){const{exact:i=!1}=e;let n;return n=i?`//input[@id = //label[normalize-space(text())="${t}"]/@for] | //label[normalize-space(text())="${t}"]//input | //input[@aria-labelledby = //label[normalize-space(text())="${t}"]/@id]`:`//input[@id = //label[contains(normalize-space(text()), "${t}")]/@for] | //label[contains(normalize-space(text()), "${t}")]//input | //input[@aria-labelledby = //label[contains(normalize-space(text()), "${t}")]/@id]`,this.locator(`xpath=${n}`)}getByPlaceholder(t,e={}){const{exact:i=!1}=e,n=i?`[placeholder="${t}"]`:`[placeholder*="${t}"]`;return this.locator(n)}getByTestId(t){return this.locator(`[data-testid="${t}"]`)}getByTitle(t,e={}){const{exact:i=!1}=e,n=i?`[title="${t}"]`:`[title*="${t}"]`;return this.locator(n)}waitForSelector(t){return l(this,arguments,function*(t,e={}){const{timeout:i=3e4,state:n="visible"}=e;if(t.startsWith("xpath="))return this.waitForXPath(t.substring(6),{timeout:i,state:n});let r=t,o=n;t.includes(":visible")?(r=t.replace(":visible",""),o="visible"):t.includes(":hidden")&&(r=t.replace(":hidden",""),o="hidden");const s=yield this.waitManager.waitForElement(r,i);return"visible"===o?yield this.waitManager.waitForCondition(()=>{const t=s.getBoundingClientRect(),e=getComputedStyle(s);return t.width>0&&t.height>0&&"hidden"!==e.visibility&&"none"!==e.display},i,`å…ƒç´  "${r}" ç­‰å¾…å¯è§è¶…æ—¶`):"hidden"===o&&(yield this.waitManager.waitForCondition(()=>{const t=s.getBoundingClientRect(),e=getComputedStyle(s);return 0===t.width||0===t.height||"hidden"===e.visibility||"none"===e.display},i,`å…ƒç´  "${r}" ç­‰å¾…éšè—è¶…æ—¶`)),s})}waitForXPath(t){return l(this,arguments,function*(t,e={}){const{timeout:i=3e4}=e;return this.waitManager.waitForCondition(()=>document.evaluate(t,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue,i,`XPath å…ƒç´ ç­‰å¾…è¶…æ—¶: ${t}`)})}waitForTimeout(t){return l(this,null,function*(){return this.waitManager.waitForTimeout(t)})}waitForFunction(t,e){return l(this,arguments,function*(t,e,i={}){const{timeout:n=3e4}=i;return this.waitManager.waitForCondition(()=>t(e),n,"ç­‰å¾…å‡½æ•°æ¡ä»¶è¶…æ—¶")})}waitForURL(t){return l(this,arguments,function*(t,e={}){const{timeout:i=3e4}=e;return this.waitManager.waitForURL(t,i)})}waitForLoadState(t="load",e=3e4){return l(this,null,function*(){return this.waitManager.waitForLoadState(t)})}evaluate(t,...e){return l(this,null,function*(){try{return t.apply(window,e)}catch(i){throw this.logger.error("è„šæœ¬æ‰§è¡Œå¤±è´¥:",i),i}})}evaluateHandle(t,...e){return l(this,null,function*(){return this.evaluate(t,...e)})}addScriptTag(){return l(this,arguments,function*(t={}){const{url:e,path:i,content:n,type:r="text/javascript"}=t,o=document.createElement("script");return o.type=r,e?o.src=e:n&&(o.textContent=n),document.head.appendChild(o),e&&(yield new Promise((t,e)=>{o.onload=t,o.onerror=e})),this.logger.debug("æ·»åŠ è„šæœ¬æ ‡ç­¾"),o})}addStyleTag(){return l(this,arguments,function*(t={}){const{url:e,path:i,content:n}=t;if(e){const t=document.createElement("link");return t.rel="stylesheet",t.href=e,document.head.appendChild(t),t}if(n){const t=document.createElement("style");return t.textContent=n,document.head.appendChild(t),t}})}scrollIntoViewIfNeeded(t){return l(this,null,function*(){const e=t.getBoundingClientRect();e.top>=0&&e.bottom<=window.innerHeight&&e.left>=0&&e.right<=window.innerWidth||(t.scrollIntoView({behavior:"smooth",block:"center"}),yield this.waitForTimeout(100),this.logger.debug("å…ƒç´ æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸ"))})}boundingBox(t){return l(this,null,function*(){const e=(yield this.waitForSelector(t)).getBoundingClientRect();return{x:e.left+window.scrollX,y:e.top+window.scrollY,width:e.width,height:e.height}})}setViewportSize(t){return l(this,null,function*(){return this.logger.warn("æµè§ˆå™¨ç¯å¢ƒä¸­æ— æ³•è®¾ç½®è§†å£å¤§å°"),{width:window.innerWidth,height:window.innerHeight}})}viewportSize(){return{width:window.innerWidth,height:window.innerHeight}}}"undefined"!=typeof window&&(window.PlaywrightPageAdapter=d),"undefined"!=typeof module&&module.exports&&(module.exports=d);let g=class t{constructor(t,e={}){this.target=t,this.isNot=!1,this.timeout=e.timeout||5e3,this.logger=new(window.PlaywrightLogger||console)}get not(){const e=new t(this.target,{timeout:this.timeout});return e.isNot=!this.isNot,e}toBeVisible(){return l(this,arguments,function*(t={}){const e=t.timeout||this.timeout,i=!this.isNot;try{yield this.waitForCondition(()=>l(this,null,function*(){return(yield this.target.isVisible())===i}),e,"æœŸæœ›å…ƒç´ "+(i?"å¯è§":"ä¸å¯è§")),this.logger.debug(`âœ… å…ƒç´ ${i?"å¯è§":"ä¸å¯è§"}æ–­è¨€é€šè¿‡`)}catch(n){const t=yield this.target.isVisible();throw new Error(`æœŸæœ›å…ƒç´ ${i?"å¯è§":"ä¸å¯è§"}ï¼Œä½†å®é™…${t?"å¯è§":"ä¸å¯è§"}`)}})}toBeHidden(){return l(this,arguments,function*(t={}){const e=t.timeout||this.timeout,i=!this.isNot;try{yield this.waitForCondition(()=>l(this,null,function*(){return(yield this.target.isVisible())!==i}),e,"æœŸæœ›å…ƒç´ "+(i?"éšè—":"å¯è§")),this.logger.debug(`âœ… å…ƒç´ ${i?"éšè—":"å¯è§"}æ–­è¨€é€šè¿‡`)}catch(n){const t=yield this.target.isVisible();throw new Error(`æœŸæœ›å…ƒç´ ${i?"éšè—":"å¯è§"}ï¼Œä½†å®é™…${t?"å¯è§":"éšè—"}`)}})}toBeEnabled(){return l(this,arguments,function*(t={}){const e=t.timeout||this.timeout,i=!this.isNot;try{yield this.waitForCondition(()=>l(this,null,function*(){return(yield this.target.isEnabled())===i}),e,"æœŸæœ›å…ƒç´ "+(i?"å¯ç”¨":"ç¦ç”¨")),this.logger.debug(`âœ… å…ƒç´ ${i?"å¯ç”¨":"ç¦ç”¨"}æ–­è¨€é€šè¿‡`)}catch(n){const t=yield this.target.isEnabled();throw new Error(`æœŸæœ›å…ƒç´ ${i?"å¯ç”¨":"ç¦ç”¨"}ï¼Œä½†å®é™…${t?"å¯ç”¨":"ç¦ç”¨"}`)}})}toBeDisabled(){return l(this,arguments,function*(t={}){const e=t.timeout||this.timeout,i=this.isNot;try{yield this.waitForCondition(()=>l(this,null,function*(){return(yield this.target.isEnabled())===i}),e,"æœŸæœ›å…ƒç´ "+(i?"å¯ç”¨":"ç¦ç”¨")),this.logger.debug(`âœ… å…ƒç´ ${i?"å¯ç”¨":"ç¦ç”¨"}æ–­è¨€é€šè¿‡`)}catch(n){const t=yield this.target.isEnabled();throw new Error(`æœŸæœ›å…ƒç´ ${i?"å¯ç”¨":"ç¦ç”¨"}ï¼Œä½†å®é™…${t?"å¯ç”¨":"ç¦ç”¨"}`)}})}toBeChecked(){return l(this,arguments,function*(t={}){const e=t.timeout||this.timeout,i=!this.isNot;try{yield this.waitForCondition(()=>l(this,null,function*(){return(yield this.target.isChecked())===i}),e,"æœŸæœ›å…ƒç´ "+(i?"é€‰ä¸­":"æœªé€‰ä¸­")),this.logger.debug(`âœ… å…ƒç´ ${i?"é€‰ä¸­":"æœªé€‰ä¸­"}æ–­è¨€é€šè¿‡`)}catch(n){const t=yield this.target.isChecked();throw new Error(`æœŸæœ›å…ƒç´ ${i?"é€‰ä¸­":"æœªé€‰ä¸­"}ï¼Œä½†å®é™…${t?"é€‰ä¸­":"æœªé€‰ä¸­"}`)}})}toHaveText(t){return l(this,arguments,function*(t,e={}){const i=e.timeout||this.timeout,n=e.useInnerText||!1;try{yield this.waitForCondition(()=>l(this,null,function*(){const e=n?yield this.target.innerText():yield this.target.textContent();let i;return i=Array.isArray(t)?t.every(t=>e.includes(t)):t instanceof RegExp?t.test(e):e.includes(t),this.isNot?!i:i}),i,`æœŸæœ›æ–‡æœ¬${this.isNot?"ä¸":""}åŒ…å« "${t}"`),this.logger.debug(`âœ… æ–‡æœ¬${this.isNot?"ä¸":""}åŒ…å«æ–­è¨€é€šè¿‡`)}catch(r){const e=n?yield this.target.innerText():yield this.target.textContent();throw new Error(`æœŸæœ›æ–‡æœ¬${this.isNot?"ä¸":""}åŒ…å« "${t}"ï¼Œä½†å®é™…æ–‡æœ¬ä¸º "${e}"`)}})}toHaveExactText(t){return l(this,arguments,function*(t,e={}){const i=e.timeout||this.timeout,n=e.useInnerText||!1;try{yield this.waitForCondition(()=>l(this,null,function*(){const e=(n?yield this.target.innerText():yield this.target.textContent()).trim()===t.trim();return this.isNot?!e:e}),i,`æœŸæœ›æ–‡æœ¬${this.isNot?"ä¸":""}å®Œå…¨åŒ¹é… "${t}"`),this.logger.debug(`âœ… ç¡®åˆ‡æ–‡æœ¬${this.isNot?"ä¸":""}åŒ¹é…æ–­è¨€é€šè¿‡`)}catch(r){const e=n?yield this.target.innerText():yield this.target.textContent();throw new Error(`æœŸæœ›æ–‡æœ¬${this.isNot?"ä¸":""}å®Œå…¨åŒ¹é… "${t}"ï¼Œä½†å®é™…æ–‡æœ¬ä¸º "${e}"`)}})}toContainText(t){return l(this,arguments,function*(t,e={}){return this.toHaveText(t,e)})}toHaveAttribute(t,e){return l(this,arguments,function*(t,e,i={}){const n=i.timeout||this.timeout;try{yield this.waitForCondition(()=>l(this,null,function*(){const i=yield this.target.getAttribute(t);let n;return n=void 0===e?null!==i:e instanceof RegExp?e.test(i||""):i===e,this.isNot?!n:n}),n,`æœŸæœ›${this.isNot?"ä¸":""}æœ‰å±æ€§ "${t}"`),this.logger.debug(`âœ… å±æ€§${this.isNot?"ä¸":""}å­˜åœ¨æ–­è¨€é€šè¿‡`)}catch(r){const i=yield this.target.getAttribute(t);throw new Error(`æœŸæœ›${this.isNot?"ä¸":""}æœ‰å±æ€§ "${t}"${void 0!==e?` = "${e}"`:""}ï¼Œä½†å®é™…å€¼ä¸º "${i}"`)}})}toHaveValue(t){return l(this,arguments,function*(t,e={}){const i=e.timeout||this.timeout;try{yield this.waitForCondition(()=>l(this,null,function*(){const e=yield this.target.inputValue();let i;return i=t instanceof RegExp?t.test(e):e===t,this.isNot?!i:i}),i,`æœŸæœ›å€¼${this.isNot?"ä¸":""}ä¸º "${t}"`),this.logger.debug(`âœ… å€¼${this.isNot?"ä¸":""}åŒ¹é…æ–­è¨€é€šè¿‡`)}catch(n){const e=yield this.target.inputValue();throw new Error(`æœŸæœ›å€¼${this.isNot?"ä¸":""}ä¸º "${t}"ï¼Œä½†å®é™…å€¼ä¸º "${e}"`)}})}toHaveClass(t){return l(this,arguments,function*(t,e={}){const i=e.timeout||this.timeout;try{yield this.waitForCondition(()=>l(this,null,function*(){const e=yield this.target.getAttribute("class"),i=e?e.split(" "):[];let n;return n=Array.isArray(t)?t.every(t=>i.includes(t)):t instanceof RegExp?t.test(e||""):i.includes(t),this.isNot?!n:n}),i,`æœŸæœ›${this.isNot?"ä¸":""}æœ‰ç±»å "${t}"`),this.logger.debug(`âœ… ç±»å${this.isNot?"ä¸":""}å­˜åœ¨æ–­è¨€é€šè¿‡`)}catch(n){const e=yield this.target.getAttribute("class");throw new Error(`æœŸæœ›${this.isNot?"ä¸":""}æœ‰ç±»å "${t}"ï¼Œä½†å®é™…ç±»åä¸º "${e}"`)}})}toHaveId(t){return l(this,arguments,function*(t,e={}){return this.toHaveAttribute("id",t,e)})}toHaveCount(t){return l(this,arguments,function*(t,e={}){const i=e.timeout||this.timeout;try{yield this.waitForCondition(()=>l(this,null,function*(){const e=(yield this.target.count())===t;return this.isNot?!e:e}),i,`æœŸæœ›æ•°é‡${this.isNot?"ä¸":""}ä¸º ${t}`),this.logger.debug(`âœ… æ•°é‡${this.isNot?"ä¸":""}åŒ¹é…æ–­è¨€é€šè¿‡`)}catch(n){const e=yield this.target.count();throw new Error(`æœŸæœ›æ•°é‡${this.isNot?"ä¸":""}ä¸º ${t}ï¼Œä½†å®é™…æ•°é‡ä¸º ${e}`)}})}toHaveURL(t){return l(this,arguments,function*(t,e={}){const i=e.timeout||this.timeout;try{yield this.waitForCondition(()=>{const e=window.location.href;let i;return i=t instanceof RegExp?t.test(e):e.includes(t),this.isNot?!i:i},i,`æœŸæœ› URL ${this.isNot?"ä¸":""}åŒ¹é… "${t}"`),this.logger.debug(`âœ… URL ${this.isNot?"ä¸":""}åŒ¹é…æ–­è¨€é€šè¿‡`)}catch(n){const e=window.location.href;throw new Error(`æœŸæœ› URL ${this.isNot?"ä¸":""}åŒ¹é… "${t}"ï¼Œä½†å½“å‰ URL ä¸º "${e}"`)}})}toHaveTitle(t){return l(this,arguments,function*(t,e={}){const i=e.timeout||this.timeout;try{yield this.waitForCondition(()=>{const e=document.title;let i;return i=t instanceof RegExp?t.test(e):e.includes(t),this.isNot?!i:i},i,`æœŸæœ›æ ‡é¢˜${this.isNot?"ä¸":""}åŒ¹é… "${t}"`),this.logger.debug(`âœ… æ ‡é¢˜${this.isNot?"ä¸":""}åŒ¹é…æ–­è¨€é€šè¿‡`)}catch(n){const e=document.title;throw new Error(`æœŸæœ›æ ‡é¢˜${this.isNot?"ä¸":""}åŒ¹é… "${t}"ï¼Œä½†å½“å‰æ ‡é¢˜ä¸º "${e}"`)}})}toContain(t){try{let e;if(Array.isArray(this.target))e=this.target.includes(t);else{if("string"!=typeof this.target)throw new Error("toContain åªæ”¯æŒæ•°ç»„æˆ–å­—ç¬¦ä¸²ç±»å‹");e=this.target.includes(t)}const i=!this.isNot;if(e!==i)throw new Error(`æœŸæœ›${i?"":"ä¸"}åŒ…å« "${t}"`);this.logger.debug(`âœ… åŒ…å«${i?"":"ä¸"}æ–­è¨€é€šè¿‡`)}catch(e){throw new Error(`æœŸæœ›${this.isNot?"ä¸":""}åŒ…å« "${t}"ï¼Œä½†ç›®æ ‡å€¼ä¸º ${JSON.stringify(this.target)}`)}}waitForCondition(t,e,i){return l(this,null,function*(){const n=Date.now(),r=()=>l(this,null,function*(){try{const e=yield t();if(e)return e}catch(o){}if(Date.now()-n>=e)throw new Error(`${i}è¶…æ—¶ (${e}ms)`);return yield new Promise(t=>setTimeout(t,100)),r()});return r()})}};function w(){return function(t){return new g(t)}}"undefined"!=typeof window&&(window.PlaywrightExpectAdapter=g,window.PlaywrightExpect=w()),"undefined"!=typeof module&&module.exports&&(module.exports={ExpectAdapter:g,createExpect:w});let f=class{constructor(){this.logger=new(window.PlaywrightLogger||console),this.setupGlobalEnvironment()}setupGlobalEnvironment(){window.PlaywrightTest={test:this.createTestFunction(),expect:window.PlaywrightExpect||this.createExpectFunction()},this.setupModuleSystem(),this.logger.debug("Playwright è¿è¡Œæ—¶ç¯å¢ƒåˆå§‹åŒ–å®Œæˆ")}createTestFunction(){const t=this;function e(e,i){return{name:e,fn:i,run:()=>l(this,null,function*(){const n={page:new window.PlaywrightPageAdapter},r=Date.now();try{t.logger.info(`ğŸ§ª å¼€å§‹æµ‹è¯•: ${e}`),yield i(n);const o=Date.now()-r;return t.logger.success(`âœ… æµ‹è¯•é€šè¿‡: ${e} (${o}ms)`),{success:!0,duration:o,name:e}}catch(o){const i=Date.now()-r;return t.logger.error(`âŒ æµ‹è¯•å¤±è´¥: ${e} (${i}ms)`,o),{success:!1,error:o,duration:i,name:e}}})}}return e.skip=(e,i)=>(t.logger.warn(`â­ï¸ è·³è¿‡æµ‹è¯•: ${e}`),{name:e,fn:i,skipped:!0,run:()=>l(this,null,function*(){return{success:!0,skipped:!0,name:e}})}),e.only=(t,i)=>{const n=e(t,i);return n.only=!0,n},e.describe=(e,i)=>(t.logger.info(`ğŸ“ æµ‹è¯•å¥—ä»¶: ${e}`),i()),e.beforeEach=t=>{e._beforeEachHooks=e._beforeEachHooks||[],e._beforeEachHooks.push(t)},e.afterEach=t=>{e._afterEachHooks=e._afterEachHooks||[],e._afterEachHooks.push(t)},e.beforeAll=t=>{e._beforeAllHooks=e._beforeAllHooks||[],e._beforeAllHooks.push(t)},e.afterAll=t=>{e._afterAllHooks=e._afterAllHooks||[],e._afterAllHooks.push(t)},e}createExpectFunction(){return function(t){return new(window.PlaywrightExpectAdapter||ExpectAdapter)(t)}}setupModuleSystem(){void 0===window.importShim&&(window.importShim={"@playwright/test":window.PlaywrightTest})}executeScript(t){return l(this,null,function*(){try{const e=this.transformImports(t),i=yield this.runInSandbox(e);return yield this.runTests(i)}catch(e){throw this.logger.error("è„šæœ¬æ‰§è¡Œå¤±è´¥:",e),e}})}transformImports(t){let e=t;const i=[/import\s*{\s*([^}]+)\s*}\s*from\s*['"]@playwright\/test['"];?/g,/import\s*{\s*([^}]+)\s*}\s*from\s*['"]@playwright\/test['"];?/g,/import\s*\*\s*as\s+(\w+)\s*from\s*['"]@playwright\/test['"];?/g];return e=e.replace(i[0],(t,e)=>`const { ${e.split(",").map(t=>t.trim()).map(t=>{const e=t.replace(/\s+as\s+\w+/,"");return`${t} = window.PlaywrightTest.${e}`}).join(", ")} } = window.PlaywrightTest;`),e=e.replace(i[2],(t,e)=>`const ${e} = window.PlaywrightTest;`),e=e.replace(/import\s*{\s*test,?\s*expect\s*}\s*from\s*['"]@playwright\/test['"];?/g,"const { test, expect } = window.PlaywrightTest;").replace(/import\s*{\s*expect,?\s*test\s*}\s*from\s*['"]@playwright\/test['"];?/g,"const { test, expect } = window.PlaywrightTest;"),this.logger.debug("Import è¯­å¥è½¬æ¢å®Œæˆ"),e}runInSandbox(t){return l(this,null,function*(){const e=[],i=window.PlaywrightTest.test,n=this;window.PlaywrightTest.test=function(t,r){const o=i(t,r);return e.push(o),n.logger.debug(`æ”¶é›†æµ‹è¯•ç”¨ä¾‹: ${t}`),o},Object.keys(i).forEach(t=>{"function"==typeof i[t]&&(window.PlaywrightTest.test[t]=i[t])});try{new Function(t)(),this.logger.info(`æ”¶é›†åˆ° ${e.length} ä¸ªæµ‹è¯•ç”¨ä¾‹`)}catch(r){throw this.logger.error("è„šæœ¬æ‰§è¡Œå‡ºé”™:",r),r}finally{window.PlaywrightTest.test=i}return e})}runTests(t){return l(this,null,function*(){const e=[],i=t.filter(t=>t.only),n=i.length>0?i:t.filter(t=>!t.skipped);this.logger.info(`å¼€å§‹æ‰§è¡Œ ${n.length} ä¸ªæµ‹è¯•`),yield this.runHooks("_beforeAllHooks");for(const t of n)try{yield this.runHooks("_beforeEachHooks",t);const i=yield t.run();e.push(i),yield this.runHooks("_afterEachHooks",t)}catch(r){this.logger.error(`æµ‹è¯•æ‰§è¡Œå¼‚å¸¸: ${t.name}`,r),e.push({success:!1,error:r,name:t.name,duration:0})}return yield this.runHooks("_afterAllHooks"),this.printTestSummary(e),e})}runHooks(t,e=null){return l(this,null,function*(){const i=window.PlaywrightTest.test[t]||[];for(const r of i)try{if(e){const t=new window.PlaywrightPageAdapter;yield r({page:t})}else yield r()}catch(n){this.logger.error(`é’©å­å‡½æ•°æ‰§è¡Œå¤±è´¥ (${t}):`,n)}})}printTestSummary(t){const e=t.filter(t=>t.success).length,i=t.filter(t=>!t.success).length,n=t.filter(t=>t.skipped).length,r=t.reduce((t,e)=>t+(e.duration||0),0);this.logger.info(`\nğŸ“Š æµ‹è¯•æ€»ç»“:\n   âœ… é€šè¿‡: ${e}\n   âŒ å¤±è´¥: ${i}\n   â­ï¸ è·³è¿‡: ${n}\n   â±ï¸ æ€»è€—æ—¶: ${r}ms\n    `),i>0&&(this.logger.error("å¤±è´¥çš„æµ‹è¯•:"),t.filter(t=>!t.success).forEach(t=>{var e;this.logger.error(`  - ${t.name}: ${null==(e=t.error)?void 0:e.message}`)}))}};"undefined"!=typeof window&&(window.PlaywrightRuntime=f),"undefined"!=typeof module&&module.exports&&(module.exports=f);class p{constructor(t={}){this.runtime=new(window.PlaywrightRuntime||PlaywrightRuntime),this.logger=new(window.PlaywrightLogger||console),this.options=s({timeout:3e4,retries:0},t)}loadAndRun(t){return l(this,null,function*(){try{this.logger.info(`ğŸ“‚ åŠ è½½è„šæœ¬: ${t}`);const e=yield fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const i=yield e.text();return yield this.runScript(i,t)}catch(e){throw this.logger.error(`è„šæœ¬åŠ è½½å¤±è´¥: ${t}`,e),e}})}runScript(t,e="inline-script"){return l(this,null,function*(){try{this.logger.info(`ğŸš€ æ‰§è¡Œè„šæœ¬: ${e}`);const i=Date.now(),n=yield this.runtime.executeScript(t),r=Date.now()-i;return this.logger.success(`âœ… è„šæœ¬æ‰§è¡Œå®Œæˆ: ${e} (${r}ms)`),{scriptName:e,duration:r,results:n,success:n.every(t=>t.success||t.skipped)}}catch(i){return this.logger.error(`è„šæœ¬æ‰§è¡Œå¤±è´¥: ${e}`,i),{scriptName:e,duration:0,results:[],success:!1,error:i}}})}runScripts(t){return l(this,null,function*(){const e=[];this.logger.info(`ğŸ“¦ æ‰¹é‡æ‰§è¡Œ ${t.length} ä¸ªè„šæœ¬`);for(const n of t)try{const t=yield this.loadAndRun(n);e.push(t)}catch(i){e.push({scriptName:n,duration:0,results:[],success:!1,error:i})}return this.printBatchSummary(e),e})}runScriptsFromPattern(t){return l(this,null,function*(){throw this.logger.warn("æµè§ˆå™¨ç¯å¢ƒä¸­æ— æ³•ç›´æ¥æ‰«ææ–‡ä»¶ç³»ç»Ÿï¼Œè¯·ä½¿ç”¨ runScripts() æ–¹æ³•"),new Error("æµè§ˆå™¨ç¯å¢ƒä¸æ”¯æŒæ–‡ä»¶ç³»ç»Ÿæ‰«æ")})}setGlobalHooks(t){const{beforeAll:e,afterAll:i,beforeEach:n,afterEach:r}=t,o=window.PlaywrightTest.test;e&&o.beforeAll(e),i&&o.afterAll(i),n&&o.beforeEach(n),r&&o.afterEach(r),this.logger.debug("å…¨å±€é’©å­è®¾ç½®å®Œæˆ")}configure(t){this.options=s(s({},this.options),t),this.logger.debug("æµ‹è¯•é…ç½®æ›´æ–°:",this.options)}printBatchSummary(t){const e=t.length,i=t.filter(t=>t.success).length,n=t.filter(t=>!t.success).length,r=t.reduce((t,e)=>t+e.results.length,0),o=t.reduce((t,e)=>t+e.results.filter(t=>t.success).length,0),s=t.reduce((t,e)=>t+e.results.filter(t=>!t.success&&!t.skipped).length,0),l=t.reduce((t,e)=>t+e.results.filter(t=>t.skipped).length,0),u=t.reduce((t,e)=>t+e.duration,0);this.logger.info(`\nğŸ¯ æ‰¹é‡æ‰§è¡Œæ€»ç»“:\nğŸ“„ è„šæœ¬ç»Ÿè®¡:\n   âœ… æˆåŠŸ: ${i}/${e}\n   âŒ å¤±è´¥: ${n}/${e}\n\nğŸ§ª æµ‹è¯•ç»Ÿè®¡:\n   âœ… é€šè¿‡: ${o}\n   âŒ å¤±è´¥: ${s}\n   â­ï¸ è·³è¿‡: ${l}\n   ğŸ“Š æ€»è®¡: ${r}\n\nâ±ï¸ æ€»è€—æ—¶: ${u}ms\n    `),n>0&&(this.logger.error("å¤±è´¥çš„è„šæœ¬:"),t.filter(t=>!t.success).forEach(t=>{var e;this.logger.error(`  - ${t.scriptName}: ${(null==(e=t.error)?void 0:e.message)||"æœªçŸ¥é”™è¯¯"}`)}))}getStats(t){var e,i,n,r,o;return Array.isArray(t)&&(null==(e=t[0])?void 0:e.results)?{scripts:{total:t.length,passed:t.filter(t=>t.success).length,failed:t.filter(t=>!t.success).length},tests:{total:t.reduce((t,e)=>t+e.results.length,0),passed:t.reduce((t,e)=>t+e.results.filter(t=>t.success).length,0),failed:t.reduce((t,e)=>t+e.results.filter(t=>!t.success&&!t.skipped).length,0),skipped:t.reduce((t,e)=>t+e.results.filter(t=>t.skipped).length,0)},duration:t.reduce((t,e)=>t+e.duration,0)}:{tests:{total:(null==(i=t.results)?void 0:i.length)||0,passed:(null==(n=t.results)?void 0:n.filter(t=>t.success).length)||0,failed:(null==(r=t.results)?void 0:r.filter(t=>!t.success&&!t.skipped).length)||0,skipped:(null==(o=t.results)?void 0:o.filter(t=>t.skipped).length)||0},duration:t.duration||0}}cleanup(){const t=window.PlaywrightTest.test;t._beforeAllHooks=[],t._afterAllHooks=[],t._beforeEachHooks=[],t._afterEachHooks=[],this.logger.debug("æµ‹è¯•è¿è¡Œå™¨æ¸…ç†å®Œæˆ")}}"undefined"!=typeof window&&(window.PlaywrightTestRunner=p),"undefined"!=typeof module&&module.exports&&(module.exports=p);class y{constructor(t={}){!function(){const t={PlaywrightLogger:u,PlaywrightWaitManager:a,PlaywrightEventSimulator:c,PlaywrightLocatorAdapter:h,PlaywrightPageAdapter:d,PlaywrightExpectAdapter:g,createExpect:w,PlaywrightRuntime:f,PlaywrightTestRunner:p},e=Object.entries(t).filter(([t,e])=>!e).map(([t])=>t);e.length>0&&console.warn("ç¼ºå°‘ä¾èµ–:",e)}(),this.options=s({logLevel:"info",timeout:3e4},t),this.logger=new u(this.options.logLevel),this.runtime=new f,this.testRunner=new p(this.options),this.logger.info("Playwright æ‰§è¡Œå¼•æ“åˆå§‹åŒ–å®Œæˆ")}runScript(t,e="inline"){return l(this,null,function*(){return yield this.testRunner.runScript(t,e)})}loadAndRun(t){return l(this,null,function*(){return yield this.testRunner.loadAndRun(t)})}runScripts(t){return l(this,null,function*(){return yield this.testRunner.runScripts(t)})}createPage(){return new d}getPage(){return this.createPage()}expect(t){return w()(t)}configure(t){return this.options=s(s({},this.options),t),this.testRunner.configure(t),this}setHooks(t){return this.testRunner.setGlobalHooks(t),this}getStats(t){return this.testRunner.getStats(t)}cleanup(){this.testRunner.cleanup()}static getVersion(){return"1.0.0-beta"}static checkCompatibility(){const t={Promises:"undefined"!=typeof Promise,"async/await":(()=>l(this,null,function*(){}))().constructor===Promise,"Fetch API":"undefined"!=typeof fetch,MutationObserver:"undefined"!=typeof MutationObserver,querySelector:void 0!==document.querySelector,addEventListener:void 0!==document.addEventListener},e=Object.entries(t).filter(([t,e])=>!e).map(([t])=>t);return!(e.length>0)||(console.warn("æµè§ˆå™¨ä¸æ”¯æŒä»¥ä¸‹åŠŸèƒ½:",e),!1)}}y.create=function(t){if(!y.checkCompatibility())throw new Error("å½“å‰æµè§ˆå™¨ä¸æ”¯æŒ Playwright æ‰§è¡Œå¼•æ“");return new y(t)},y.run=function(t){return l(this,arguments,function*(t,e={}){const i=y.create(e);return yield i.runScript(t)})},y.load=function(t){return l(this,arguments,function*(t,e={}){const i=y.create(e);return yield i.loadAndRun(t)})},y.Components={Logger:u,WaitManager:a,EventSimulator:c,PageAdapter:d,LocatorAdapter:h,ExpectAdapter:g,Runtime:f,TestRunner:p},"undefined"!=typeof window&&(window.PlaywrightExecutionEngine=y,window.PWEngine=y,window.runPlaywrightScript=y.run,window.loadPlaywrightScript=y.load,console.log("ğŸ­ Playwright æ‰§è¡Œå¼•æ“å·²åŠ è½½å®Œæˆ"),console.log("ç‰ˆæœ¬:",y.getVersion()),console.log("ä½¿ç”¨æ–¹æ³•: new PlaywrightExecutionEngine() æˆ– PlaywrightExecutionEngine.create()")),t.PlaywrightEventSimulator=c,t.PlaywrightExpectAdapter=g,t.PlaywrightLocatorAdapter=h,t.PlaywrightLogger=u,t.PlaywrightPageAdapter=d,t.PlaywrightRuntime=f,t.PlaywrightTestRunner=p,t.PlaywrightWaitManager=a,t.createExpect=w,t.default=y,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=playwright-execution-engine.umd.js.map
